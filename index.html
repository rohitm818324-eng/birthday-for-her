<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Birthday My Love</title>

<link rel="stylesheet" href="file/default.css">

<script src="file/jquery.min.js"></script>
<script src="file/jscex.min.js"></script>
<script src="file/jscex-parser.js"></script>
<script src="file/jscex-jit.js"></script>
<script src="file/jscex-builderbase.min.js"></script>
<script src="file/jscex-async.min.js"></script>
<script src="file/jscex-async-powerpack.min.js"></script>
<script src="file/function.js"></script>
<script src="file/love.js"></script>

<script>
function playAudio() {
    var audio = document.getElementById("myAudio");
    audio.play().catch(() => {});
}
</script>
</head>

<body>
<div id="main">
<div id="error">Please use Chrome or Firefox</div>

<audio id="myAudio" preload="auto" playsinline>
    <source src="aud.mp3" type="audio/mp3">
</audio>

<div id="wrap">
<div id="text">
<div id="code" style="display:none;">
<span class="say">Hey Harshada... My Love üíû</span><br>
<span class="say">Happy Birthday üéà</span><br>
<span class="say">May God bless you üçÄ</span><br>
<span class="say">And fill your life with endless happiness üíï</span><br>
<span class="say">You are beautiful inside and out ‚ù§Ô∏è</span><br>
<span class="say">You make my world brighter every single day</span><br>
<span class="say">Sending you lots of love and smiles ‚ù§Ô∏èüòò</span><br>
<span class="say">Hope today is as special as you ‚ú®</span><br>
<span class="say">Forever yours üíï</span>
</div>
</div>

<div id="clock-box">
<span id="clock">577 days 0 hours 0 minutes 0 seconds</span>
</div>

<canvas id="canvas" width="1100" height="680"></canvas>
</div>
</div>

<script>
(function () {
var canvas = $('#canvas');

if (!canvas[0].getContext) {
    $("#error").show();
    return;
}

var width = canvas.width();
var height = canvas.height();
canvas.attr("width", width);
canvas.attr("height", height);

var opts = {
seed: { x: width / 2 - 20, color: "rgb(190,26,37)", scale: 2 },
branch: [[[535,680,570,250,500,200,30,100]]],
bloom: { num: 700, width: 1080, height: 650 },
footer: { width: 1200, height: 5, speed: 10 }
};

var tree = new Tree(canvas[0], width, height, opts);
var seed = tree.seed;
var foot = tree.footer;
var hold = 1;

canvas.click(function (e) {
    playAudio();
    var offset = canvas.offset();
    var x = e.pageX - offset.left;
    var y = e.pageY - offset.top;
    if (seed.hover(x, y)) {
        hold = 0;
        canvas.off("click mousemove");
        canvas.removeClass('hand');
    }
}).mousemove(function (e) {
    var offset = canvas.offset();
    canvas.toggleClass('hand',
        seed.hover(e.pageX - offset.left, e.pageY - offset.top));
});

var seedAnimate = eval(Jscex.compile("async", function () {
    seed.draw();
    while (hold) { $await(Jscex.Async.sleep(10)); }
}));

var growAnimate = eval(Jscex.compile("async", function () {
    while (tree.canGrow()) {
        tree.grow();
        $await(Jscex.Async.sleep(10));
    }
}));

var flowAnimate = eval(Jscex.compile("async", function () {
    while (tree.canFlower()) {
        tree.flower(2);
        $await(Jscex.Async.sleep(10));
    }
}));

var textAnimate = eval(Jscex.compile("async", function () {
    $("#code").show().typewriter();
}));

var runAsync = eval(Jscex.compile("async", function () {
    $await(seedAnimate());
    $await(growAnimate());
    $await(flowAnimate());
    textAnimate().start();
}));

runAsync().start();
})();
</script>
</body>
</html>
